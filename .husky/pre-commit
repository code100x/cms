#!/usr/bin/env sh
# . "$(dirname -- "$0")/_/husky.sh"

npx lint-staged
git add .

if [ "$npm_execpath" | grep -q "pnpm"; then
  RED='\033[0;31m'
  NC='\033[0m'
  printf "${RED}"
  echo "-----------------------------------------------"
  echo "|                                             |"
  echo "|  ERROR: 'Using npm !'                       |"
  echo "|  PLEASE use pnpm instead of npm             |"
  echo "|                                             |"
  echo "-----------------------------------------------"
  printf "${NC}"
  exit 1
fi

if [ -f "yarn.lock" ] || [ -f "package-lock.json" ]; then
  RED='\033[0;31m'
  NC='\033[0m'
  printf "${RED}"
  echo "-----------------------------------------------"
  echo "|                                             |"
  echo "|  ERROR: 'yarn.lock' or 'package-lock.json'  |"
  echo "|  IS PRESENT!                                |"
  echo "|  PLEASE REMOVE THEM BEFORE COMMITTING.      |"
  echo "|                                             |"
  echo "|  Try:                                       |"
  echo "|    \`rm yarn.lock\`                           |"
  echo "|    \`rm package-lock.json\`                   |"
  echo "|                                             |"
  echo "-----------------------------------------------"
  printf "${NC}"
  exit 1
fi
